\documentclass[a4paper,11pt,twoside]{book}
%\documentclass[11pt,twoside,letterpaper]{book}
\usepackage{a4wide}
%\usepackage{multirow}
\usepackage{footnote}
\usepackage{amsbsy}
\usepackage[dvips]{graphicx}
%\usepackage{fancyheadings}
\usepackage{fancyhdr}
%\setlength{\parindent}{0in}
%\setlength{\parskip}{0.05in}
\setlength{\parskip}{0.1in}

%\usepackage{a4wide}
\usepackage{color}
\def\red{\textcolor{red}}

%\parskip=2mm

% Ensure that blank pages don't have numbers or heading on them 
\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
 \hbox{}
 \vspace*{\fill}
 \thispagestyle{empty}
 \newpage\fi\fi}
\makeatother

% set fancy headings
\pagestyle{fancy}
\lhead[{\it \thepage}]{{\bf\it {\tt OptaDOS}: User Guide}}
\chead{}
\rhead[{\bf\it {\tt OptaDOS}: User Guide}]{{\it \thepage}}
\renewcommand{\headrulewidth}{0.2pt}
\lfoot{}
\cfoot{}
\rfoot{}
\renewcommand{\footrulewidth}{0pt}
\setlength{\footskip}{0.25in}
\setlength{\parindent}{0in}

\title{{\tt OptaDOS}: User Guide}

\author{Version 0.9}

\date{27th October 2010}

\begin{document}
\newcommand{\optados}{\texttt{OptaDOS}}
\newcommand{\lindos}{\texttt{LinDOS}}
\newcommand{\castep}{\textsc{castep}}
\maketitle

\setcounter{tocdepth}{1}
\tableofcontents

\chapter{Introduction}\label{chap:introduction}
\section{Background}
\optados\ is a code for calculating optical, core-level excitation spectra along with full, partial and joint electronic density of states (DOS).  The code was developed by merging the \lindos\ code of Andrew Morris and Chris Pickard at University College London with the optical properties code of Rebecca Nicholls and Jonathan Yates at Oxford University.  \optados\ is written in Fortran 95 and may be run in parallel using {\tt MPI}.  At present \optados\ interfaces with \castep\ output files, although it is extendible to perform calculations on any set of band eigenvalues and their derivatives generated by any electronic structure code.

The code is freely available through the GPL licence with the request that the following citation (quoted in full) is required in any publication resulting from the use of \optados.

\emph{Andrew\,J. Morris, R.\,J. Nicholls, C.\,J. Pickard and Jonathan\,R. Yates, The \optados\ code, CPC (2011)}.

\begin{center}
Further information and examples can be found at

\verb#www.optados.org#
\end{center}


\section{Features}
\optados\ generates optical, core-level excitation spectra along with full, partial and joint electronic DOS. The DOS, PDOS and JDOS take advantage of the linear and adaptive smearing schemes which are more accurate than standard Gaussian smearing since they exploit knowledge of the gradients of the bands at each k-point in the Brillouin zone.  These DOS are the basis of the more advanced functionality of \optados, the core and optical spectra.

Along with data text files \optados\ also generates \verb#.agr# files of results to be read by \verb#grace#. 


\chapter{Getting Started}\label{chap:getting_started}
\section{Installation}
\optados\ is usually obtained in a gzipped tarball, \verb#optados-X.X.tar.gz#. Extract this ( \verb# tar -xzf optados-X.X.tar.gz#) in the desired directory. Inside the  \verb#optados/# directory are a number of sub directories,  \verb#documents/#,  \verb#source/#,  \verb#examples/#.  The code may be compiled using the \verb#Makefile# in the  \verb#optados/# directory.  The \verb#SYSTEM#, \verb#BUILD#, \verb#COMMS_ARCH# and \verb#BIN_DIR# flags must be set, either in the  \verb#Makefile#, or from the command line (for example  \verb#make BUILD=fast#).  

\subsection[system]{\tt SYSTEM}

Tells the build system which compiler to use to make \optados. The valid values are:
\begin{itemize}
\item[{\bf --}]  \verb#g95# (default)
\item[{\bf --}]  \verb#gfortran#
\item[{\bf --}]  \verb#ifort#
\item[{\bf --}]  \verb#nag#
\item[{\bf --}]  \verb#pathscale#
\item[{\bf --}]  \verb#pgf90#
\end{itemize}

\subsection[build]{\tt BUILD}

Tells the build system the level of optimisations required when making \optados.  The valid values are:
\begin{itemize}
\item[{\bf --}]  \verb#fast# (default) All optimisations
\item[{\bf --}]  \verb#debug# No optimisations, full debug information
\end{itemize}

\subsection[comms_arch]{\tt COMMS\_ARCH}

Tells the build system whether to compile for serial or parallel execution. The valid values are:
\begin{itemize}
\item[{\bf --}]  \verb#serial# (default) 
\item[{\bf --}]  \verb#mpi# 
\end{itemize}

\subsection[bin_dir]{\tt BIN\_DIR}
Tells the build system where to place the \optados\ binary. The default is the \optados\ directory.


\section{Usage}
{\tt
\begin{quote}
optados.x  [seedname]
\end{quote} }
\begin{itemize}
\item{ {\tt seedname}: If a seedname string is given the code will read its input
from a file {\tt seedname.odi}. The default value is {\tt castep}.}
\end{itemize}

\chapter{Parameters}\label{chap:parameters}

\section{{\tt seedname.odi} File}
The \optados\ input file {\tt seedname.odi} has a flexible free-form
structure. 

The ordering of the keywords is not significant. Case is ignored (so
\verb#smearing_width# is the same as \verb#Smearing_Width#). Characters after !, or \#
are treated as comments. Most keywords have a default value that is
used unless the keyword is given in {\tt seedname.odi}. Keywords can be set
in any of the following ways
{\tt
\begin{quote}
smearing\_width = 0.4

smearing\_width : 0.4

smearing\_width   0.4
\end{quote} }
A logical keyword can be set to {\tt .true.} using any of the following
strings: {\tt T}, {\tt true}, {\tt .true.}.


\clearpage


\section{Parameters}
\subsection[task]{\tt character(len=50) :: task}

Tells the code what to compute. 

The valid options for this parameter are:
\begin{itemize}
\item[{\bf --}]  \verb#dos# (default)
\item[{\bf --}]  \verb#jdos#
\item[{\bf --}]  \verb#pdos#
\item[{\bf --}]  \verb#optics#
\item[{\bf --}]  \verb#core#
\item[{\bf --}]  \verb#all#
\end{itemize}
Several taks can be specified eg to compute dos and jdos use
\verb#task : dos jdos#.

\subsection[broadening]{\tt character(len=50) :: broadening}

Specified the scheme used to broaden a discrete sampling of the
Brillouin Zone to a continuous spectral function.

The valid options for this parameter are:
\begin{itemize}
\item[{\bf --}]  \verb#adaptive# (default)
\item[{\bf --}]  \verb#fixed#
\item[{\bf --}]  \verb#linear#
\item[{\bf --}]  \verb#quad#
\end{itemize}
Several schemes can be specified eg 
\verb#broadening : adaptive fixed#.

\subsection[iprint]{\tt integer :: iprint}

This indicates the level of verbosity of the output from 1,
the bare minimum, to 3, which corresponds to full debugging output.

The default value is 1.


\subsection[length\_unit]{\tt character(len=20) :: energy\_unit}
The energy unit to be used for writing quantities in the output files.

The valid options for this parameter are:
\begin{itemize}
\item[{\bf --}]  \verb#eV# (default)
\item[{\bf --}]  \verb#Ry#
\item[{\bf --}]  \verb#Ha#
\end{itemize}

\subsection[adaptive\_smearing]{\tt real(kind=dp) :: adaptive\_smearing}
Set the relative smearing in the adaptive scheme

Default value is 1.4

\subsection[fixed\_smearing]{\tt real(kind=dp) :: fixed\_smearing}
Smearing width for fixed broadening

If $\verb#spectral_scheme# = \verb#fixed#$ default value is 0.3eV.

\subsection[scissor\_op]{\tt real(kind=dp) :: scissor\_op}
Value of the scissor operator. 

Default value is 0eV (ie not used)

\subsection[compute\_efermi]{{\tt logical :: compute\_efermi}}

If {\tt compute\_efermi=TRUE}, then \optados\ will use the value of the fermi
level computed from the integration of the DOS. If {\tt
  compute\_efermi=FALSE}, then the value set by {\tt fermi\_energy} will be
used, if {\tt fermi\_energy} is not set the value from the bands file will be used.

The default value is {\tt FALSE}.

\subsection[fermi\_energy]{\tt real(kind=dp) :: fermi\_energy}
Value of the fermi energy

No default value

\subsection[output\_format]{\tt character(len=20) :: output\_format}
Format in which to output data

The valid options for this parameter are:
\begin{itemize}
\item[{\bf --}]  \verb#gnuplot#
\item[{\bf --}]  \verb#grace# (default)
\end{itemize}

\subsection[finite\_bin\_correction]{\tt logical :: finite\_bin\_correction}


\subsection[set\_efermi\_zero]{\tt logical :: set\_efermi\_zero}


\subsection[dos\_min\_energy]{\tt real(kind=dp) :: dos\_min\_energy}
Lower energy range for DOS and related properties.

Default value is 5eV below the lowest eigenvalue in the bands file.

\subsection[dos\_max\_energy]{\tt real(kind=dp) :: dos\_max\_energy}
Upper energy range for DOS and related properties.

Default value is 5eV above the highest eigenvalue in the bands file.

\subsection[dos\_spacing]{\tt real(kind=dp) :: dos\_spacing}
Resolution at which to compute the DOS and related properties.
Default value is 0.1eV (AJM??)

\subsection[jdos\_max\_energy]{\tt real(kind=dp) :: jdos\_max\_energy}
Upper energy range for JDOS and related properties.

Default value is the difference between the valence band maximum (or
fermi level) and the highest eigenvalue in the bands file.

\subsection[jdos\_spacing]{\tt real(kind=dp) :: jdos\_spacing} 
Resolution at which to compute the DOS and related properties.
Default value is 0.1eV (AJM??)

\subsection[optics\_geom]{\tt character(len=20) :: optics\_geom}

\begin{itemize}
\item[{\bf --}]  \verb#polycrystalline# (Isotropic average)
\item[{\bf --}]  \verb#polarized#  
\item[{\bf --}]  \verb#unpolarized# 
\item[{\bf --}]  \verb#tensor# (Full dielectric tensor)
\end{itemize}


\subsection[optics\_qdir]{\tt real(kind=dp) :: optics\_qdir(3)}
Direction of polarisation. Must be specified if \verb#optics_geom :polarized#  
or \verb#optics_geom : unpolarized# .
No default


\subsection[pdos]{\tt integer :: pdos}
Defines which components to include in the pdos analysis:

\begin{itemize}
\item[{\bf --}]  \verb#angular# (decompose as s,p,d etc)
\item[{\bf --}]  \verb#atom#    (decompose onto atomic sites)
\item[{\bf --}]  \verb#C:H#     (decompose onto Carbon and Hydrogen sites)
\item[{\bf --}]  \verb#C1:C3:C4-C8#  (decompose onto atoms C1, C2 and C4,C5,C6,C7,C8)
\item[{\bf --}]  \verb#Si1[s;d]#     (decompose onto 's' and 'd' channels for
  atom Si1)

\end{itemize}





\subsection[devel\_flag]{\tt character(len=50) :: devel\_flag}

Not a regular keyword. Its purpose is to allow a developer to pass a
string into the code to be used inside a new routine as it is developed.

No default.




\end{document}
